"use strict";(self.webpackChunkreact=self.webpackChunkreact||[]).push([[501],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>j});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),p=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},l=function(e){var t=p(e.components);return o.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),u=p(n),m=r,j=u["".concat(s,".").concat(m)]||u[m]||d[m]||a;return n?o.createElement(j,c(c({ref:t},l),{},{components:n})):o.createElement(j,c({ref:t},l))}));function j(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,c=new Array(a);c[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[u]="string"==typeof e?e:r,c[1]=i;for(var p=2;p<a;p++)c[p]=n[p];return o.createElement.apply(null,c)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5066:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>c,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var o=n(7462),r=(n(7294),n(3905));const a={title:"Lab 25: Redux with React"},c=void 0,i={unversionedId:"labs/js/ReduxWithReact",id:"labs/js/ReduxWithReact",title:"Lab 25: Redux with React",description:"Objectives",source:"@site/docs/labs/js/25-ReduxWithReact.md",sourceDirName:"labs/js",slug:"/labs/js/ReduxWithReact",permalink:"/docs/labs/js/ReduxWithReact",draft:!1,tags:[],version:"current",sidebarPosition:25,frontMatter:{title:"Lab 25: Redux with React"}},s={},p=[{value:"Objectives",id:"objectives",level:2},{value:"Steps",id:"steps",level:2},{value:"Refactor the Page (container) component to use React Redux Hooks",id:"refactor-the-page-container-component-to-use-react-redux-hooks",level:3},{value:"Refactor the Form component to dispatch an action",id:"refactor-the-form-component-to-dispatch-an-action",level:3},{value:"\u2714 You have completed Lab 25",id:"-you-have-completed-lab-25",level:3},{value:"Bonus Exercise (optional)",id:"bonus-exercise-optional",level:2}],l={toc:p},u="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,o.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"objectives"},"Objectives"),(0,r.kt)("ul",{className:"contains-task-list"},(0,r.kt)("li",{parentName:"ul",className:"task-list-item"},(0,r.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Refactor the Page (container) component to use React Redux Hooks"),(0,r.kt)("li",{parentName:"ul",className:"task-list-item"},(0,r.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Refactor the Form component to dispatch an action")),(0,r.kt)("h2",{id:"steps"},"Steps"),(0,r.kt)("h3",{id:"refactor-the-page-container-component-to-use-react-redux-hooks"},"Refactor the Page (container) component to use React Redux Hooks"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Remove the Page (container) component's local state and replace with Redux state using useSelector. Also, get a reference to the Store's dispatch function using useDispatch so we can dispatch actions."),(0,r.kt)("h4",{parentName:"li",id:"srcprojectsprojectspagejs"},(0,r.kt)("inlineCode",{parentName:"h4"},"src\\projects\\ProjectsPage.js")),(0,r.kt)("blockquote",{parentName:"li"},(0,r.kt)("p",{parentName:"blockquote"},"Make sure you are in Project",(0,r.kt)("strong",{parentName:"p"},"s"),"Page.js not ProjectPage.js.")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"- import React, { useState, useEffect } from 'react';\n+ import React, { useEffect } from 'react';\nimport ProjectList from './ProjectList';\n- import { Project } from './Project';\n+ import { useSelector, useDispatch } from 'react-redux';\n\nfunction ProjectsPage() {\n-  const [projects, setProjects] = useState<Project[]>([]);\n-  const [loading, setLoading] = useState(false);\n-  const [error, setError] = useState(undefined);\n-  const [currentPage, setCurrentPage] = useState(1);\n\n+  const loading = useSelector(\n+    (appState) => appState.projectState.loading\n+  );\n+  const projects = useSelector(\n+    (appState) => appState.projectState.projects\n+  );\n+  const error = useSelector(\n+    (appState) => appState.projectState.error\n+  );\n+  const currentPage = useSelector(\n+    (appState) => appState.projectState.page\n+  );\n+  const dispatch = useDispatch();\n\n...\n}\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Replace state setter function calls and API calls with calls to dispatch passing action creators. Also, remove the ",(0,r.kt)("inlineCode",{parentName:"p"},"onSave")," function and stop passing it as a prop to the ",(0,r.kt)("inlineCode",{parentName:"p"},"<ProjectList/>")," component."),(0,r.kt)("h4",{parentName:"li",id:"srcprojectsprojectspagejs-1"},(0,r.kt)("inlineCode",{parentName:"h4"},"src\\projects\\ProjectsPage.js")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"...\n- import { Project } from './Project';\n- import { projectAPI } from './projectAPI';\n+ import { loadProjects } from './state/projectActions';\n\nfunction ProjectsPage() {\n  ...\n  const dispatch = useDispatch();\n\n-  useEffect(() => {\n-    setLoading(true);\n-    projectAPI\n-      .get(currentPage)\n-      .then((data) => {\n-        setLoading(false);\n-        if (currentPage === 1) {\n-          setProjects(data);\n-        } else {\n-          setProjects((projects) => [...projects, ...data]);\n-        }\n-      })\n-      .catch((e) => {\n-        setLoading(false);\n-        setError(e.message);\n-      });\n-  }, [currentPage]);\n\n+  useEffect(() => {\n+    dispatch(loadProjects(1));\n+  }, [dispatch]);\n\n  const handleMoreClick = () => {\n-    setCurrentPage((currentPage) => currentPage + 1);\n+    dispatch(loadProjects(currentPage + 1));\n  };\n\n-  const saveProject = (project) => {\n-    projectAPI\n-      .put(project)\n-      .then((updatedProject) => {\n-        let updatedProjects = projects.map((p) => {\n-          return p.id === project.id ? project : p;\n-        });\n-        setProjects(updatedProjects);\n-      })\n-      .catch((e) => {\n-        setError(e.message);\n-      });\n-  };\n\n  return (\n    <Fragment>\n      ...\n-      <ProjectList onSave={saveProject} projects={projects} />\n+      <ProjectList projects={projects} />\n      ...\n    </Fragment>\n  );\n}\n...\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Provide the store."),(0,r.kt)("h4",{parentName:"li",id:"srcappjs"},(0,r.kt)("inlineCode",{parentName:"h4"},"src\\App.js")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-diff"},'import ProjectPage from \'./projects/ProjectPage\';\n+ import { Provider } from \'react-redux\';\n+ import { store } from \'./state\';\n\nfunction App() {\n  return (\n+    <Provider store={store}>\n      <Router>\n        <header className="sticky">\n          <span className="logo">\n            <img src="/assets/logo-3.svg" alt="logo" width="49" height="99" />\n          </span>\n          <NavLink to="/"  className="button rounded">\n            <span className="icon-home"></span>\n            Home\n          </NavLink>\n          <NavLink to="/projects/" className="button rounded">\n            Projects\n          </NavLink>\n        </header>\n        <div className="container">\n          <Routes>\n            <Route path="/"  component={HomePage} />\n            <Route path="/projects"  component={ProjectsPage} />\n            <Route path="/projects/:id" component={ProjectPage} />\n          </Routes>\n        </div>\n      </Router>\n+   </Provider>\n  );\n};\n\nexport default App;\n')))),(0,r.kt)("h3",{id:"refactor-the-form-component-to-dispatch-an-action"},"Refactor the Form component to dispatch an action"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Refactor the Form component so it dispatches the ",(0,r.kt)("inlineCode",{parentName:"p"},"saveProject")," action instead of receiving the function as a prop."),(0,r.kt)("h4",{parentName:"li",id:"srcprojectsprojectformjs"},(0,r.kt)("inlineCode",{parentName:"h4"},"src\\projects\\ProjectForm.js")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"import React, { SyntheticEvent, useState } from 'react';\n+ import { useDispatch } from 'react-redux';\nimport { Project } from './Project';\n+ import { saveProject } from './state/projectActions';\n\nfunction ProjectForm({\n  project: initialProject,\n- onSave,\n  onCancel,\n}) {\n  const [project, setProject] = useState(initialProject);\n  const [errors, setErrors] = useState({\n    name: '',\n    description: '',\n    budget: '',\n  });\n\n+  const dispatch = useDispatch();\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    if (!isValid()) return;\n-    onSave(project);\n+    dispatch(saveProject(project));\n  };\n\n  const handleChange = (event) => {\n    ...\n  };\n\n  function validate(project) {\n  ...\n  }\n\n  function isValid() {\n    ...\n  }\n\n  return (\n    <form className=\"input-group vertical\" onSubmit={handleSubmit}>\n    ...\n    </form>\n  );\n}\n\nProjectForm.propTypes = {\n-  onSave: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n};\nexport default ProjectForm;\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Provide the store."),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"This was already done in ",(0,r.kt)("inlineCode",{parentName:"li"},"src\\App.js")," because it is inherited from the parent Page component: Page =>List=>Form."))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the ",(0,r.kt)("inlineCode",{parentName:"p"},"ProjectList")," component, remove ",(0,r.kt)("inlineCode",{parentName:"p"},"onSave")," in the ",(0,r.kt)("inlineCode",{parentName:"p"},"propTypes")," definition and update the component to not pass ",(0,r.kt)("inlineCode",{parentName:"p"},"onSave")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"<ProjectForm>")," as it is now dispatches this action itself after importing it."),(0,r.kt)("h4",{parentName:"li",id:"srcprojectsprojectlistjs"},(0,r.kt)("inlineCode",{parentName:"h4"},"src\\Projects\\ProjectList.js")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"import React, { useState } from 'react';\nimport { Project } from './Project';\nimport ProjectCard from './ProjectCard';\nimport ProjectForm from './ProjectForm';\n\n- function ProjectList({ projects, onSave }) {\n+ function ProjectList({ projects }) {\n  const [projectBeingEdited, setProjectBeingEdited] = useState({});\n\n  const handleEdit = (project) => {\n    setProjectBeingEdited(project);\n  };\n\n  const cancelEditing = () => {\n    setProjectBeingEdited({});\n  };\n\n  return (\n    <div className=\"row\">\n      {projects.map((project) => (\n        <div key={project.id} className=\"cols-sm\">\n          {project === projectBeingEdited ? (\n            <ProjectForm project={project}\n-             onSave={onSave}\n              onCancel={cancelEditing} />\n          ) : (\n            <ProjectCard project={project} onEdit={handleEdit} />\n          )}\n        </div>\n      ))}\n    </div>\n  );\n }\n\n ProjectList.propTypes = {\n   projects: PropTypes.arrayOf(PropTypes.instanceOf(Project)).isRequired,\n-  onSave: PropTypes.func.isRequired\n };\nexport default ProjectList;\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Verify")," the application still works including loading and updating the projects."))),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"-you-have-completed-lab-25"},"\u2714"," You have completed Lab 25"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Please let the instructor know you have completed this lab before continuing to the bonus exercise.")),(0,r.kt)("h2",{id:"bonus-exercise-optional"},"Bonus Exercise (optional)"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Do this exercise in your own time outside of class or while waiting for other students to finish the labs.")),(0,r.kt)("p",null,"Now that you have the ",(0,r.kt)("inlineCode",{parentName:"p"},"ProjectsPage")," (plural) refactored to use ",(0,r.kt)("inlineCode",{parentName:"p"},"Redux"),", use what you have learned to change the ",(0,r.kt)("inlineCode",{parentName:"p"},"ProjectPage")," (singular) code to use ",(0,r.kt)("inlineCode",{parentName:"p"},"Redux")," as well."),(0,r.kt)("p",null,"Not giving you specific directions on how to do this is intentional at this point. It is time to see if you can apply what you learned without specific guidance. Tip: Remember, it is perfectly valid to reference your existing code from the last few labs to complete this exercise."))}d.isMDXComponent=!0}}]);